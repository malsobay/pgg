{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/api/batches/server/publications.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/empirica:core/api/batches/server/publications.js","filename":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/api/batches/server/publications.js","passPerPreset":false,"envName":"development","cwd":"/Users/tilenbabnik/Desktop/pgg","root":"/Users/tilenbabnik/Desktop/pgg","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.9.2","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/api/batches/server/publications.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/empirica:core/api/batches/server/publications.js"}},"code":"let GameLobbies;\nmodule.link(\"../../game-lobbies/game-lobbies\", {\n  GameLobbies(v) {\n    GameLobbies = v;\n  }\n\n}, 0);\nlet Games;\nmodule.link(\"../../games/games\", {\n  Games(v) {\n    Games = v;\n  }\n\n}, 1);\nlet Rounds;\nmodule.link(\"../../rounds/rounds\", {\n  Rounds(v) {\n    Rounds = v;\n  }\n\n}, 2);\nlet Stages;\nmodule.link(\"../../stages/stages\", {\n  Stages(v) {\n    Stages = v;\n  }\n\n}, 3);\nlet Batches;\nmodule.link(\"../batches\", {\n  Batches(v) {\n    Batches = v;\n  }\n\n}, 4);\nMeteor.publish(\"admin-batches\", function (props) {\n  if (!this.userId) {\n    return null;\n  }\n\n  if (!props || props.archived === undefined) {\n    return Batches.find();\n  }\n\n  return Batches.find({\n    archivedAt: {\n      $exists: Boolean(props.archived)\n    }\n  });\n});\nMeteor.publish(\"admin-batch\", function (_ref) {\n  let {\n    batchId\n  } = _ref;\n\n  if (!this.userId) {\n    return null;\n  }\n\n  if (!batchId) {\n    return null;\n  }\n\n  return [GameLobbies.find({\n    batchId\n  }), Games.find({\n    batchId\n  })];\n});\nMeteor.publish(\"admin-batch-game\", function (_ref2) {\n  let {\n    gameId\n  } = _ref2;\n\n  if (!this.userId) {\n    return null;\n  }\n\n  if (!gameId) {\n    return null;\n  }\n\n  return [Rounds.find({\n    gameId\n  }), Stages.find({\n    gameId\n  })];\n});\nMeteor.publish(\"runningBatches\", function (_ref3) {\n  let {\n    playerId\n  } = _ref3;\n  return Batches.find({\n    status: \"running\",\n    full: false\n  }, {\n    fields: {\n      _id: 1,\n      full: 1\n    }\n  });\n});","map":{"version":3,"sources":["packages/empirica:core/api/batches/server/publications.js"],"names":["GameLobbies","module","link","v","Games","Rounds","Stages","Batches","Meteor","publish","props","userId","archived","undefined","find","archivedAt","$exists","Boolean","batchId","gameId","playerId","status","full","fields","_id"],"mappings":"AAAA,IAAIA,WAAJ;AAAgBC,MAAM,CAACC,IAAP,CAAY,iCAAZ,EAA8C;AAACF,EAAAA,WAAW,CAACG,CAAD,EAAG;AAACH,IAAAA,WAAW,GAACG,CAAZ;AAAc;;AAA9B,CAA9C,EAA8E,CAA9E;AAAiF,IAAIC,KAAJ;AAAUH,MAAM,CAACC,IAAP,CAAY,mBAAZ,EAAgC;AAACE,EAAAA,KAAK,CAACD,CAAD,EAAG;AAACC,IAAAA,KAAK,GAACD,CAAN;AAAQ;;AAAlB,CAAhC,EAAoD,CAApD;AAAuD,IAAIE,MAAJ;AAAWJ,MAAM,CAACC,IAAP,CAAY,qBAAZ,EAAkC;AAACG,EAAAA,MAAM,CAACF,CAAD,EAAG;AAACE,IAAAA,MAAM,GAACF,CAAP;AAAS;;AAApB,CAAlC,EAAwD,CAAxD;AAA2D,IAAIG,MAAJ;AAAWL,MAAM,CAACC,IAAP,CAAY,qBAAZ,EAAkC;AAACI,EAAAA,MAAM,CAACH,CAAD,EAAG;AAACG,IAAAA,MAAM,GAACH,CAAP;AAAS;;AAApB,CAAlC,EAAwD,CAAxD;AAA2D,IAAII,OAAJ;AAAYN,MAAM,CAACC,IAAP,CAAY,YAAZ,EAAyB;AAACK,EAAAA,OAAO,CAACJ,CAAD,EAAG;AAACI,IAAAA,OAAO,GAACJ,CAAR;AAAU;;AAAtB,CAAzB,EAAiD,CAAjD;AAM1TK,MAAM,CAACC,OAAP,CAAe,eAAf,EAAgC,UAASC,KAAT,EAAgB;AAC9C,MAAI,CAAC,KAAKC,MAAV,EAAkB;AAChB,WAAO,IAAP;AACD;;AAED,MAAI,CAACD,KAAD,IAAUA,KAAK,CAACE,QAAN,KAAmBC,SAAjC,EAA4C;AAC1C,WAAON,OAAO,CAACO,IAAR,EAAP;AACD;;AAED,SAAOP,OAAO,CAACO,IAAR,CAAa;AAAEC,IAAAA,UAAU,EAAE;AAAEC,MAAAA,OAAO,EAAEC,OAAO,CAACP,KAAK,CAACE,QAAP;AAAlB;AAAd,GAAb,CAAP;AACD,CAVD;AAYAJ,MAAM,CAACC,OAAP,CAAe,aAAf,EAA8B,gBAAsB;AAAA,MAAb;AAAES,IAAAA;AAAF,GAAa;;AAClD,MAAI,CAAC,KAAKP,MAAV,EAAkB;AAChB,WAAO,IAAP;AACD;;AAED,MAAI,CAACO,OAAL,EAAc;AACZ,WAAO,IAAP;AACD;;AAED,SAAO,CAAClB,WAAW,CAACc,IAAZ,CAAiB;AAAEI,IAAAA;AAAF,GAAjB,CAAD,EAAgCd,KAAK,CAACU,IAAN,CAAW;AAAEI,IAAAA;AAAF,GAAX,CAAhC,CAAP;AACD,CAVD;AAYAV,MAAM,CAACC,OAAP,CAAe,kBAAf,EAAmC,iBAAqB;AAAA,MAAZ;AAAEU,IAAAA;AAAF,GAAY;;AACtD,MAAI,CAAC,KAAKR,MAAV,EAAkB;AAChB,WAAO,IAAP;AACD;;AAED,MAAI,CAACQ,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AAED,SAAO,CAACd,MAAM,CAACS,IAAP,CAAY;AAAEK,IAAAA;AAAF,GAAZ,CAAD,EAA0Bb,MAAM,CAACQ,IAAP,CAAY;AAAEK,IAAAA;AAAF,GAAZ,CAA1B,CAAP;AACD,CAVD;AAYAX,MAAM,CAACC,OAAP,CAAe,gBAAf,EAAiC,iBAAuB;AAAA,MAAd;AAAEW,IAAAA;AAAF,GAAc;AACtD,SAAOb,OAAO,CAACO,IAAR,CACL;AAAEO,IAAAA,MAAM,EAAE,SAAV;AAAqBC,IAAAA,IAAI,EAAE;AAA3B,GADK,EAEL;AAAEC,IAAAA,MAAM,EAAE;AAAEC,MAAAA,GAAG,EAAE,CAAP;AAAUF,MAAAA,IAAI,EAAE;AAAhB;AAAV,GAFK,CAAP;AAID,CALD","sourcesContent":["import { GameLobbies } from \"../../game-lobbies/game-lobbies\";\nimport { Games } from \"../../games/games\";\nimport { Rounds } from \"../../rounds/rounds\";\nimport { Stages } from \"../../stages/stages\";\nimport { Batches } from \"../batches\";\n\nMeteor.publish(\"admin-batches\", function(props) {\n  if (!this.userId) {\n    return null;\n  }\n\n  if (!props || props.archived === undefined) {\n    return Batches.find();\n  }\n\n  return Batches.find({ archivedAt: { $exists: Boolean(props.archived) } });\n});\n\nMeteor.publish(\"admin-batch\", function({ batchId }) {\n  if (!this.userId) {\n    return null;\n  }\n\n  if (!batchId) {\n    return null;\n  }\n\n  return [GameLobbies.find({ batchId }), Games.find({ batchId })];\n});\n\nMeteor.publish(\"admin-batch-game\", function({ gameId }) {\n  if (!this.userId) {\n    return null;\n  }\n\n  if (!gameId) {\n    return null;\n  }\n\n  return [Rounds.find({ gameId }), Stages.find({ gameId })];\n});\n\nMeteor.publish(\"runningBatches\", function({ playerId }) {\n  return Batches.find(\n    { status: \"running\", full: false },\n    { fields: { _id: 1, full: 1 } }\n  );\n});\n"]},"sourceType":"module","hash":"8b221bd9c982ab37c95a9ccb0b169b8431bfbb2c"}
