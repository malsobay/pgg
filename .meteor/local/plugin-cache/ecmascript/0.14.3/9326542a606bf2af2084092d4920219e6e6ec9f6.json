{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/startup/server/bootstrap.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/empirica:core/startup/server/bootstrap.js","filename":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/startup/server/bootstrap.js","passPerPreset":false,"envName":"development","cwd":"/Users/tilenbabnik/Desktop/pgg","root":"/Users/tilenbabnik/Desktop/pgg","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.9.2","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/startup/server/bootstrap.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/empirica:core/startup/server/bootstrap.js"}},"code":"module.export({\n  bootstrapFunctions: () => bootstrapFunctions,\n  bootstrap: () => bootstrap\n});\nlet log;\nmodule.link(\"../../lib/log.js\", {\n  default(v) {\n    log = v;\n  }\n\n}, 0);\nconst admins = [];\nconst settingsAdmins = Meteor.settings.admins;\n\nif (settingsAdmins) {\n  if (!_.isArray(settingsAdmins)) {\n    log.error(\"settings: `admins` field is not an array\");\n  } else {\n    settingsAdmins.forEach((_ref) => {\n      let {\n        username,\n        password\n      } = _ref;\n\n      if (!username || !password) {\n        log.error(\"settings: `admins` require `username` and `password`\");\n      } else {\n        admins.push({\n          username,\n          password\n        });\n      }\n    });\n  }\n}\n\nif (admins.length === 0) {\n  const tempPassword = Math.random().toString(36).slice(2) + Math.random().toString(36).slice(2);\n  admins.push({\n    username: \"admin\",\n    password: tempPassword\n  });\n  log.warn(\"You have not set a custom password for admin login.\\nIf you have a settings file (e.g. local.json) with \\\"admins\\\" configured, you can\\nrestart the app passing in the settings arg: \\\"meteor --settings local.json\\\".\\nYou can temporarily log in with (reset on each app reload):\\n  - username: admin\\n  - password: \".concat(tempPassword, \"\\n\"));\n}\n\nconst bootstrapFunctions = [];\n\nconst bootstrap = () => {\n  bootstrapFunctions.forEach(f => f());\n  log.debug(\"Bootstrapped!\");\n};\n\nMeteor.startup(() => {\n  bootstrap();\n});\nbootstrapFunctions.push(() => {\n  admins.forEach(admin => {\n    const exists = Meteor.users.findOne(_.omit(admin, \"password\"));\n\n    if (!exists) {\n      Accounts.createUser(admin);\n    } else {\n      Accounts.setPassword(exists._id, admin.password, {\n        logout: false\n      });\n    }\n  });\n});","map":{"version":3,"sources":["packages/empirica:core/startup/server/bootstrap.js"],"names":["module","export","bootstrapFunctions","bootstrap","log","link","default","v","admins","settingsAdmins","Meteor","settings","_","isArray","error","forEach","username","password","push","length","tempPassword","Math","random","toString","slice","warn","f","debug","startup","admin","exists","users","findOne","omit","Accounts","createUser","setPassword","_id","logout"],"mappings":"AAAAA,MAAM,CAACC,MAAP,CAAc;AAACC,EAAAA,kBAAkB,EAAC,MAAIA,kBAAxB;AAA2CC,EAAAA,SAAS,EAAC,MAAIA;AAAzD,CAAd;AAAmF,IAAIC,GAAJ;AAAQJ,MAAM,CAACK,IAAP,CAAY,kBAAZ,EAA+B;AAACC,EAAAA,OAAO,CAACC,CAAD,EAAG;AAACH,IAAAA,GAAG,GAACG,CAAJ;AAAM;;AAAlB,CAA/B,EAAmD,CAAnD;AAE3F,MAAMC,MAAM,GAAG,EAAf;AAEA,MAAMC,cAAc,GAAGC,MAAM,CAACC,QAAP,CAAgBH,MAAvC;;AACA,IAAIC,cAAJ,EAAoB;AAClB,MAAI,CAACG,CAAC,CAACC,OAAF,CAAUJ,cAAV,CAAL,EAAgC;AAC9BL,IAAAA,GAAG,CAACU,KAAJ,CAAU,0CAAV;AACD,GAFD,MAEO;AACLL,IAAAA,cAAc,CAACM,OAAf,CAAuB,UAA4B;AAAA,UAA3B;AAAEC,QAAAA,QAAF;AAAYC,QAAAA;AAAZ,OAA2B;;AACjD,UAAI,CAACD,QAAD,IAAa,CAACC,QAAlB,EAA4B;AAC1Bb,QAAAA,GAAG,CAACU,KAAJ,CAAU,sDAAV;AACD,OAFD,MAEO;AACLN,QAAAA,MAAM,CAACU,IAAP,CAAY;AAAEF,UAAAA,QAAF;AAAYC,UAAAA;AAAZ,SAAZ;AACD;AACF,KAND;AAOD;AACF;;AAED,IAAIT,MAAM,CAACW,MAAP,KAAkB,CAAtB,EAAyB;AACvB,QAAMC,YAAY,GAChBC,IAAI,CAACC,MAAL,GACGC,QADH,CACY,EADZ,EAEGC,KAFH,CAES,CAFT,IAGAH,IAAI,CAACC,MAAL,GACGC,QADH,CACY,EADZ,EAEGC,KAFH,CAES,CAFT,CAJF;AAQAhB,EAAAA,MAAM,CAACU,IAAP,CAAY;AACVF,IAAAA,QAAQ,EAAE,OADA;AAEVC,IAAAA,QAAQ,EAAEG;AAFA,GAAZ;AAKAhB,EAAAA,GAAG,CAACqB,IAAJ,mUAMcL,YANd;AASD;;AAEM,MAAMlB,kBAAkB,GAAG,EAA3B;;AACA,MAAMC,SAAS,GAAG,MAAM;AAC7BD,EAAAA,kBAAkB,CAACa,OAAnB,CAA2BW,CAAC,IAAIA,CAAC,EAAjC;AACAtB,EAAAA,GAAG,CAACuB,KAAJ,CAAU,eAAV;AACD,CAHM;;AAKPjB,MAAM,CAACkB,OAAP,CAAe,MAAM;AACnBzB,EAAAA,SAAS;AACV,CAFD;AAIAD,kBAAkB,CAACgB,IAAnB,CAAwB,MAAM;AAC5BV,EAAAA,MAAM,CAACO,OAAP,CAAec,KAAK,IAAI;AACtB,UAAMC,MAAM,GAAGpB,MAAM,CAACqB,KAAP,CAAaC,OAAb,CAAqBpB,CAAC,CAACqB,IAAF,CAAOJ,KAAP,EAAc,UAAd,CAArB,CAAf;;AACA,QAAI,CAACC,MAAL,EAAa;AACXI,MAAAA,QAAQ,CAACC,UAAT,CAAoBN,KAApB;AACD,KAFD,MAEO;AACLK,MAAAA,QAAQ,CAACE,WAAT,CAAqBN,MAAM,CAACO,GAA5B,EAAiCR,KAAK,CAACZ,QAAvC,EAAiD;AAAEqB,QAAAA,MAAM,EAAE;AAAV,OAAjD;AACD;AACF,GAPD;AAQD,CATD","sourcesContent":["import log from \"../../lib/log.js\";\n\nconst admins = [];\n\nconst settingsAdmins = Meteor.settings.admins;\nif (settingsAdmins) {\n  if (!_.isArray(settingsAdmins)) {\n    log.error(\"settings: `admins` field is not an array\");\n  } else {\n    settingsAdmins.forEach(({ username, password }) => {\n      if (!username || !password) {\n        log.error(\"settings: `admins` require `username` and `password`\");\n      } else {\n        admins.push({ username, password });\n      }\n    });\n  }\n}\n\nif (admins.length === 0) {\n  const tempPassword =\n    Math.random()\n      .toString(36)\n      .slice(2) +\n    Math.random()\n      .toString(36)\n      .slice(2);\n\n  admins.push({\n    username: \"admin\",\n    password: tempPassword\n  });\n\n  log.warn(\n    `You have not set a custom password for admin login.\nIf you have a settings file (e.g. local.json) with \"admins\" configured, you can\nrestart the app passing in the settings arg: \"meteor --settings local.json\".\nYou can temporarily log in with (reset on each app reload):\n  - username: admin\n  - password: ${tempPassword}\n`\n  );\n}\n\nexport const bootstrapFunctions = [];\nexport const bootstrap = () => {\n  bootstrapFunctions.forEach(f => f());\n  log.debug(\"Bootstrapped!\");\n};\n\nMeteor.startup(() => {\n  bootstrap();\n});\n\nbootstrapFunctions.push(() => {\n  admins.forEach(admin => {\n    const exists = Meteor.users.findOne(_.omit(admin, \"password\"));\n    if (!exists) {\n      Accounts.createUser(admin);\n    } else {\n      Accounts.setPassword(exists._id, admin.password, { logout: false });\n    }\n  });\n});\n"]},"sourceType":"module","hash":"9326542a606bf2af2084092d4920219e6e6ec9f6"}
