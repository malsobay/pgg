{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/ui/components/InstructionSteps.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"packages/empirica:core/ui/components/InstructionSteps.jsx","filename":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/ui/components/InstructionSteps.jsx","passPerPreset":false,"envName":"development","cwd":"/Users/tilenbabnik/Desktop/pgg","root":"/Users/tilenbabnik/Desktop/pgg","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.9.2","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/tilenbabnik/Desktop/pgg/packages/empirica:core/ui/components/InstructionSteps.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/empirica:core/ui/components/InstructionSteps.jsx"}},"code":"let _extends;\n\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n\n}, 0);\n\nlet _objectSpread;\n\nmodule.link(\"@babel/runtime/helpers/objectSpread2\", {\n  default(v) {\n    _objectSpread = v;\n  }\n\n}, 1);\n\nlet _objectWithoutProperties;\n\nmodule.link(\"@babel/runtime/helpers/objectWithoutProperties\", {\n  default(v) {\n    _objectWithoutProperties = v;\n  }\n\n}, 2);\nmodule.export({\n  default: () => InstructionSteps\n});\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n\n}, 0);\nlet Loading;\nmodule.link(\"./Loading.jsx\", {\n  default(v) {\n    Loading = v;\n  }\n\n}, 1);\n\nclass InstructionSteps extends React.Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      current: 0\n    };\n\n    this.onNext = () => {\n      let {\n        onDone,\n        player\n      } = this.props;\n      let {\n        steps,\n        current\n      } = this.state;\n      current = current + 1;\n\n      if (current >= steps.length) {\n        onDone();\n        return;\n      }\n\n      this.setState({\n        current\n      });\n      window.currentIntroStep[player._id] = current;\n    };\n\n    this.onPrev = () => {\n      const {\n        player\n      } = this.props;\n      let current = this.state.current - 1;\n      this.setState({\n        current\n      });\n      window.currentIntroStep[player._id] = current;\n    };\n\n    this.resetIntroSteps = () => {\n      const {\n        player\n      } = this.props;\n      this.setState({\n        current: 0\n      });\n\n      if (!window.currentIntroStep) {\n        return;\n      }\n\n      if (!window.currentIntroStep[player._id]) {\n        return;\n      }\n\n      window.currentIntroStep[player._id] = 0;\n    };\n  }\n\n  componentDidMount() {\n    this.setIntroStepIndex();\n  }\n\n  setIntroStepIndex() {\n    const {\n      player\n    } = this.props;\n\n    if (!window.currentIntroStep) {\n      window.currentIntroStep = {};\n      return;\n    }\n\n    const currentIntroStep = window.currentIntroStep[player._id];\n\n    if (!currentIntroStep) {\n      return;\n    }\n\n    this.setState({\n      current: currentIntroStep\n    });\n  }\n\n  componentWillMount() {\n    const {\n      introSteps,\n      treatment,\n      onDone\n    } = this.props;\n    const factors = treatment.factorsObject();\n    const steps = introSteps({\n      treatment: factors\n    }, factors);\n    const noInstruction = !steps || steps.length === 0;\n\n    if (noInstruction) {\n      onDone();\n    }\n\n    this.setState({\n      steps,\n      noInstruction\n    });\n  }\n\n  render() {\n    const _this$props = this.props,\n          {\n      treatment,\n      player\n    } = _this$props,\n          rest = _objectWithoutProperties(_this$props, [\"treatment\", \"player\"]);\n\n    const {\n      steps,\n      current,\n      noInstruction\n    } = this.state;\n\n    if (noInstruction) {\n      return /*#__PURE__*/React.createElement(Loading, null);\n    }\n\n    const Step = steps[current];\n    const hasNext = steps.length - 1 > current;\n    const hasPrev = current > 0;\n    const conds = treatment.factorsObject();\n\n    const introPlayer = _objectSpread({}, player, {\n      resetIntroSteps: this.resetIntroSteps\n    });\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"introduction-steps\"\n    }, /*#__PURE__*/React.createElement(Step, _extends({}, rest, {\n      hasPrev: hasPrev,\n      hasNext: hasNext,\n      onPrev: this.onPrev,\n      onNext: this.onNext,\n      player: introPlayer,\n      treatment: conds,\n      game: {\n        treatment: conds\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["packages/empirica:core/ui/components/InstructionSteps.jsx"],"names":["_extends","module","link","default","v","_objectSpread","_objectWithoutProperties","export","InstructionSteps","React","Loading","Component","state","current","onNext","onDone","player","props","steps","length","setState","window","currentIntroStep","_id","onPrev","resetIntroSteps","componentDidMount","setIntroStepIndex","componentWillMount","introSteps","treatment","factors","factorsObject","noInstruction","render","rest","Step","hasNext","hasPrev","conds","introPlayer"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Loading from \"./Loading.jsx\";\n\nexport default class InstructionSteps extends React.Component {\n  state = { current: 0 };\n\n  componentDidMount() {\n    this.setIntroStepIndex();\n  }\n\n  setIntroStepIndex() {\n    const { player } = this.props;\n    if (!window.currentIntroStep) {\n      window.currentIntroStep = {};\n      return;\n    }\n\n    const currentIntroStep = window.currentIntroStep[player._id];\n    if (!currentIntroStep) {\n      return;\n    }\n\n    this.setState({ current: currentIntroStep });\n  }\n\n  componentWillMount() {\n    const { introSteps, treatment, onDone } = this.props;\n\n    const factors = treatment.factorsObject();\n    const steps = introSteps({ treatment: factors }, factors);\n\n    const noInstruction = !steps || steps.length === 0;\n\n    if (noInstruction) {\n      onDone();\n    }\n\n    this.setState({ steps, noInstruction });\n  }\n\n  onNext = () => {\n    let { onDone, player } = this.props;\n    let { steps, current } = this.state;\n    current = current + 1;\n    if (current >= steps.length) {\n      onDone();\n      return;\n    }\n    this.setState({ current });\n    window.currentIntroStep[player._id] = current;\n  };\n\n  onPrev = () => {\n    const { player } = this.props;\n    let current = this.state.current - 1;\n\n    this.setState({ current });\n    window.currentIntroStep[player._id] = current;\n  };\n\n  resetIntroSteps = () => {\n    const { player } = this.props;\n    this.setState({ current: 0 });\n\n    if (!window.currentIntroStep) {\n      return;\n    }\n\n    if (!window.currentIntroStep[player._id]) {\n      return;\n    }\n\n    window.currentIntroStep[player._id] = 0;\n  };\n\n  render() {\n    const { treatment, player, ...rest } = this.props;\n    const { steps, current, noInstruction } = this.state;\n\n    if (noInstruction) {\n      return <Loading />;\n    }\n\n    const Step = steps[current];\n    const hasNext = steps.length - 1 > current;\n    const hasPrev = current > 0;\n    const conds = treatment.factorsObject();\n    const introPlayer = { ...player, resetIntroSteps: this.resetIntroSteps };\n\n    return (\n      <div className=\"introduction-steps\">\n        <Step\n          {...rest}\n          hasPrev={hasPrev}\n          hasNext={hasNext}\n          onPrev={this.onPrev}\n          onNext={this.onNext}\n          player={introPlayer}\n          treatment={conds}\n          game={{ treatment: conds }}\n        />\n      </div>\n    );\n  }\n}\n"]},"sourceType":"module","hash":"cfec9403f6f5850afaea924435cc73bab2df5a36"}
